{
    "type": "Ext.app.Controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userClassName": "UIController"
    },
    "designerId": "fb00b353-fb0f-4c6c-b6be-18fe058eaa8e",
    "cn": [
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "onCareTap",
                "fn": "onCareTap",
                "implHandler": [
                    "var me = this,care;\r",
                    "\r",
                    "care = Ext.create('CareMe.view.CarePanel', {title: 'iCare'});\r",
                    "console.log(me);\r",
                    "me.getMainView().push(care);\r",
                    ""
                ],
                "name": "tap",
                "designer|targetType": "Ext.Button",
                "designer|controlQuery": "mainview button[text='iCare']"
            },
            "designerId": "0ba968d9-84b4-4653-886a-023f2171e23c"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "mainView",
                "designer|displayName": "mainView",
                "ref": "mainView",
                "selector": "mainview"
            },
            "designerId": "34dd9223-4040-46b3-af96-125028602179"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "onProfileButtonTap",
                "fn": "onProfileButtonTap",
                "implHandler": [
                    "var me = this,profile;\r",
                    "\r",
                    "profile = Ext.create('CareMe.view.ProfilePanel', {title: 'Profile'});\r",
                    "me.getMainView().push(profile);\r",
                    ""
                ],
                "name": "tap",
                "designer|targetType": "Ext.Button",
                "designer|controlQuery": "mainview button[text='Profile']"
            },
            "designerId": "ca95f474-0fe2-4f05-b323-b1bd45f886dc"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "onCarelendarButtonTap",
                "fn": "onCarelendarButtonTap",
                "implHandler": [
                    "var me = this,calendar;\r",
                    "\r",
                    "calendar = Ext.create('CareMe.view.CalendarPanel', {title: 'Calendar'});\r",
                    "me.getMainView().push(calendar);\r",
                    ""
                ],
                "name": "tap",
                "designer|targetType": "Ext.Button",
                "designer|controlQuery": "mainview button[text='Carelendar']"
            },
            "designerId": "8399bb06-8faa-43bd-b849-f289ec3d721d"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "onHistoryButtonTap",
                "fn": "onHistoryButtonTap",
                "implHandler": [
                    "var me = this,history;\r",
                    "\r",
                    "history = Ext.create('CareMe.view.HistoryPanel', {title: 'History'});\r",
                    "me.getMainView().push(history);\r",
                    ""
                ],
                "name": "tap",
                "designer|targetType": "Ext.Button",
                "designer|controlQuery": "mainview button[text='History']"
            },
            "designerId": "54fa0b12-b23f-4d77-b70f-ad160d1fb3d5"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "onLogInButtonTap",
                "fn": "onLogInButtonTap",
                "implHandler": [
                    "",
                    "var _this = this, loginPanel, mainView, ",
                    "usernameField, passwordField, ",
                    "username, password, label;",
                    "",
                    "loginPanel = _this.getLoginPanel();",
                    "mainView = _this.getMainView();",
                    "",
                    "usernameField = loginPanel.down('#userNameTextField');",
                    "passwordField = loginPanel.down('#passwordTextField');",
                    "label = loginPanel.down('#signInFailedLabel');",
                    "",
                    "username = usernameField.getValue();",
                    "password = passwordField.getValue();",
                    "label.hide();",
                    "",
                    "console.log('=====' + loginPanel);",
                    "console.log('=====' + mainView);",
                    "console.log('username : ' + username);",
                    "console.log('password: ' + password);",
                    "",
                    "var task = Ext.create('Ext.util.DelayedTask', function () {",
                    "    label.setHtml('');",
                    "    _this.onSignIn(username, password);",
                    "    usernameField.setValue('');",
                    "    passwordField.setValue('');",
                    "});",
                    "task.delay(500);",
                    "",
                    ""
                ],
                "name": "tap",
                "designer|targetType": "Ext.Button",
                "designer|controlQuery": "loginpanel button[itemId='logInButton']"
            },
            "designerId": "e30c340f-7ade-4572-903b-ec71be3bb364"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "loginPanel",
                "designer|displayName": "loginPanel",
                "ref": "loginPanel",
                "selector": "loginpanel"
            },
            "designerId": "1bd4cd35-59e5-450e-b850-1edc9a155514"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "getSlideLeftTransition",
                "fn": "getSlideLeftTransition",
                "implHandler": [
                    "return { type: 'slide', direction: 'left' };\r",
                    ""
                ]
            },
            "designerId": "d6a5a27d-ba2c-455e-9dd5-cbede8e4be8a"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "getTransitionEffect",
                "fn": "getTransitionEffect",
                "designer|params": [
                    "type",
                    "direction"
                ],
                "implHandler": [
                    "return { 'type': type, 'direction':  direction };"
                ]
            },
            "designerId": "66c3a44c-8241-4baa-b1ab-91a6b7bf6998"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "loginFailure",
                "fn": "loginFailure",
                "implHandler": [
                    "var loginPanel, _this = this;",
                    "loginPanel.showSignInFailedMessage(message);",
                    "loginPanel.setMasked(false);",
                    ""
                ]
            },
            "designerId": "d2951133-31a7-44f5-a210-ef5a5c637638"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "loginSuccess",
                "fn": "loginSuccess",
                "implHandler": [
                    ""
                ]
            },
            "designerId": "24a57fde-1a4e-496d-b545-ae8fb5931b71"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "onSignIn",
                "fn": "onSignIn",
                "designer|params": [
                    "username",
                    "password"
                ],
                "implHandler": [
                    "var _this = this,",
                    "    loginPanel = _this.getLoginPanel();",
                    "",
                    "console.log('-- onSignIn() --');",
                    "",
                    "if (username.length === 0 || password.length === 0) {",
                    "    console.log(' onSignIn() - login failure!');",
                    "    loginPanel.showSignInFailedMessage('Please enter your username and password.');",
                    "    loginPanel.setMasked(false);",
                    "    return;",
                    "",
                    "} else {",
                    "",
                    "    console.log('onSignIn() - Signed in.');",
                    "    loginPanel = _this.getLoginPanel();",
                    "    mainView = _this.getMainView();",
                    "    loginPanel.setMasked(false);",
                    "    //===============",
                    "    Ext.Ajax.request({",
                    "        url: 'http://192.168.0.103:9000/login',",
                    "        method: 'POST',",
                    "        params: {",
                    "            'email':username,",
                    "            'password':password",
                    "        },",
                    "        success: function(response) {",
                    "            var text = response.responseText;",
                    "            var json = JSON.parse(text);",
                    "            if(json.status === \"OK\") {",
                    "                console.log('---- Login Ok ----');",
                    "                var mainView = _this.getMainView();",
                    "                Ext.Viewport.animateActiveItem(mainView, _this.getTransitionEffect('slide', 'left'));  ",
                    "\t\t\t\tvar store = Ext.getStore(\"SessionStore\");",
                    "                var s = new CareMe.model.Session({'email': username, 'session': json.session});",
                    "                store.add(s);",
                    "\t\t\t\tstore.sync();",
                    "                debug = store;",
                    "            } else {",
                    "                var text = response.responseText;",
                    "                var json = JSON.parse(text);",
                    "                loginPanel.showSignInFailedMessage(json.message);",
                    "                loginPanel.setMasked(false);            ",
                    "                console.log(json);        ",
                    "                //ERROR label",
                    "                console.log('Error login');",
                    "            }",
                    "        }, ",
                    "        failure : function(response) {",
                    "            Ext.Msg.alert('Error','Error while submitting the form');",
                    "            var text = response.responseText;",
                    "            var json = JSON.parse(text);",
                    "            console.log(json);      ",
                    "        }",
                    "    });",
                    "",
                    "}",
                    ""
                ]
            },
            "designerId": "37eeb082-33d4-4c89-9d1c-22268c800497"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "onRegisterSubmit",
                "fn": "onRegisterSubmit",
                "designer|params": [
                    "username",
                    "password"
                ],
                "implHandler": [
                    "var _this = this, registerPanel;",
                    "",
                    "registerPanel = _this.getRegisterPanel();",
                    "",
                    "console.log(' -- onRegisterSubmit() --');",
                    "/*",
                    "TODO:",
                    "1. ajax submit",
                    "2. verify result",
                    "- fail response then display error label",
                    "- simple verification",
                    "3. display main view",
                    "",
                    "*/",
                    "//Ext.Viewport.animateActiveItem(registerPanel, _this.getTransitionEffect('slide', 'down'));",
                    "",
                    "Ext.Ajax.request({",
                    "    url: 'http://192.168.0.103:9000/register',",
                    "    method: 'POST',",
                    "    params: {",
                    "        'u.email':username,",
                    "        'u.password':password,",
                    "        'u.name':'Demo User'",
                    "    },",
                    "    success: function(response) {",
                    "        var text = response.responseText;",
                    "        var json = JSON.parse(text);",
                    "        if(json.status === \"OK\") {",
                    "            var mainView = _this.getMainView();",
                    "            Ext.Viewport.animateActiveItem(mainView, _this.getTransitionEffect('slide', 'left'));  ",
                    "            var store = Ext.create('Ext.data.Store', {",
                    "                model: \"CareMe.model.Session\"",
                    "            });",
                    "            store.add({email: username});",
                    "            store.add({session: json.session});   ",
                    "            console.log(store);",
                    "        } else {",
                    "            var text = response.responseText;",
                    "            var json = JSON.parse(text);",
                    "            console.log(json);        ",
                    "            //ERROR label",
                    "            console.log('Error register');",
                    "        }",
                    "    }, ",
                    "    failure : function(response) {",
                    "        Ext.Msg.alert('Error','Error while submitting the form');",
                    "        var text = response.responseText;",
                    "        var json = JSON.parse(text);",
                    "        console.log(json);      ",
                    "    }",
                    "});"
                ]
            },
            "designerId": "e92e0b99-c61c-4092-aff7-5e4cadb62829"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "onRegister",
                "fn": "onRegister",
                "implHandler": [
                    "var _this = this, registerPanel;",
                    "",
                    "registerPanel = _this.getRegisterPanel();",
                    "",
                    "console.log(' -- onRegister() --');",
                    "",
                    "",
                    "Ext.Viewport.animateActiveItem(registerPanel, _this.getTransitionEffect('slide', 'down'));"
                ]
            },
            "designerId": "a0d51265-00c2-45c0-b836-e2c6b3718dc7"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "onRegisterCancel",
                "fn": "onRegisterCancel",
                "implHandler": [
                    "var _this = this, loginPanel;",
                    "",
                    "loginPanel = _this.getLoginPanel();",
                    "",
                    "console.log(' -- onRegisterCancel() --');",
                    "",
                    "Ext.Viewport.animateActiveItem(loginPanel, _this.getTransitionEffect('slide', 'up'));"
                ]
            },
            "designerId": "087f58c7-ffa1-4bf6-bec1-2d7075c790ab"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "registerPanel",
                "designer|displayName": "registerPanel",
                "ref": "registerPanel",
                "selector": "registerpanel"
            },
            "designerId": "80f5780c-cac4-4cc2-81b6-0984cb683ac1"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "onCancelButtonTap",
                "fn": "onCancelButtonTap",
                "implHandler": [
                    "var _this = this;",
                    "var task = Ext.create('Ext.util.DelayedTask', function () {",
                    "    _this.onRegisterCancel();",
                    "});",
                    "task.delay(500);",
                    ""
                ],
                "name": "tap",
                "designer|targetType": "Ext.Button",
                "designer|controlQuery": "registerpanel button[itemId='cancel']"
            },
            "designerId": "7f96389c-da03-467f-9e31-615fea9fbf78"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "onRegisterSubmitButtonTap",
                "fn": "onRegisterSubmitButtonTap",
                "implHandler": [
                    "var _this = this, usernameField, passwordField,\r",
                    "    username, password;\r",
                    "\r",
                    "regPanel = _this.getRegisterPanel();\r",
                    "mainView = _this.getMainView();\r",
                    "\r",
                    "usernameField = regPanel.down('#userNameTextField');\r",
                    "passwordField = regPanel.down('#passwordTextField');\r",
                    "\r",
                    "username = usernameField.getValue();\r",
                    "password = passwordField.getValue();\r",
                    "\r",
                    "var task = Ext.create('Ext.util.DelayedTask', function () {\r",
                    "    _this.onRegisterSubmit(username, password);\r",
                    "});\r",
                    "\r",
                    "task.delay(500);\r",
                    ""
                ],
                "name": "tap",
                "designer|targetType": "Ext.Button",
                "designer|controlQuery": "registerpanel button[itemId='registerSubmit']"
            },
            "designerId": "eeb07e18-c08c-4531-9c44-f84f09106c1a"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "onRegisterButtonTap",
                "fn": "onRegisterButtonTap",
                "implHandler": [
                    "var _this = this;",
                    "var task = Ext.create('Ext.util.DelayedTask', function () {",
                    "    _this.onRegister();",
                    "});",
                    "task.delay(500);",
                    ""
                ],
                "name": "tap",
                "designer|targetType": "Ext.Button",
                "designer|controlQuery": "loginpanel button[itemId='register']"
            },
            "designerId": "dad92f0c-d47b-4825-b092-c3dc77f0b8db"
        }
    ]
}